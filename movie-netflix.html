<!DOCTYPE html>
<html lang="en" data-bs-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MovieStream - Free Movies Online</title>
    <!-- Bootstrap 5.3 CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.1/font/bootstrap-icons.min.css"
        rel="stylesheet">
    <style>
        :root {
            --movie-card-height: 350px;
            --movie-card-mobile-height: 180px;
        }

        .movie-card {
            transition: transform 0.3s;
            height: var(--movie-card-height);
            position: relative;
            overflow: hidden;
            width: 230px;
            flex-shrink: 0;
        }
 
        .movie-card:hover {
            transform: scale(1.05);
            z-index: 1;
        }

        .movie-poster {
            height: 100%;
            width: 100%;
            object-fit: cover;
        }

        .movie-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.8) 50%);
            padding: 20px;
            color: white;
            transition: all 0.3s;
        }

        .hero-section {
            height: 500px;
            background-size: cover;
            background-position: center;
            position: relative;
            transition: opacity 1s ease;
        }

        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to right, rgba(0, 0, 0, 0.8), transparent);
            display: flex;
            align-items: center;
            padding-left: 5%;
        }

        .category-pill {
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-pill:hover {
            transform: scale(1.1);
        }

        /* Custom scrollbar for movie rows */
        .scroll-container {
            overflow-x: auto;
            scrollbar-width: thin;
            padding-bottom: 10px;
            -webkit-overflow-scrolling: touch;
            /* Smooth scrolling on iOS */
        }

        .scroll-container::-webkit-scrollbar {
            height: 6px;
        }

        .scroll-container::-webkit-scrollbar-thumb {
            background-color: var(--bs-primary);
            border-radius: 20px;
        }

        /* For dark mode */
        [data-bs-theme="dark"] .navbar {
            background-color: #1a1d20 !important;
        }

        [data-bs-theme="dark"] .bg-light {
            background-color: #212529 !important;
        }

        [data-bs-theme="dark"] .text-dark {
            color: #f8f9fa !important;
        }

        [data-bs-theme="dark"] .card {
            background-color: #2c3034;
        }

        footer {
            margin-top: 2rem;
            padding: 2rem 0;
        }

        /* Mobile Optimizations */
        @media (max-width: 767px) {
            .hero-section {
                height: 350px;
            }

            .hero-overlay {
                background: linear-gradient(to right, rgba(0, 0, 0, 0.9), rgba(0, 0, 0, 0.7));
                padding: 15px;
            }

            .movie-card {
                height: var(--movie-card-mobile-height);
                width: 120px;
            }

            .movie-overlay {
                padding: 10px;
            }

            .movie-overlay h5 {
                font-size: 0.9rem;
                margin-bottom: 5px;
            }

            .movie-overlay .badge {
                font-size: 0.7rem;
            }

            .movie-overlay .btn-sm {
                padding: 0.2rem 0.4rem;
                font-size: 0.7rem;
            }

            .category-pills-container {
                overflow-x: auto;
                white-space: nowrap;
                padding-bottom: 10px;
                -webkit-overflow-scrolling: touch;
            }
        }

        /* Small mobile specific styles */
        @media (max-width: 380px) {
            .movie-card {
                width: 110px;
                height: 160px;
            }

            .movie-overlay {
                padding: 8px;
            }

            .movie-overlay h5 {
                font-size: 0.8rem;
                margin-bottom: 3px;
            }

            .btn-actions {
                display: flex;
                gap: 4px;
            }

            .btn-actions .btn {
                padding: 2px 4px;
                font-size: 0.6rem;
            }
        }

        /* Hero section responsive text */
        @media (max-width: 576px) {
            .hero-section h1 {
                font-size: 1.8rem;
            }

            .hero-section .lead {
                font-size: 1rem;
            }

            .hero-section .btn-lg {
                padding: 0.375rem 0.75rem;
                font-size: 0.9rem;
            }
        }

        /* Netflix-style Sidebar */
        body {
            padding-left: 0;
            transition: padding-left 0.3s ease;
        }

        body.sidebar-expanded {
            padding-left: 250px;
        }

        .netflix-sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 70px;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 1050;
            overflow-x: hidden;
            transition: width 0.3s ease;
            display: flex;
            flex-direction: column;
        }

        .netflix-sidebar.expanded {
            width: 250px;
        }

        /* Consolidate these overlapping media queries */
        @media (min-width: 769px) {
            body {
                padding-left: 70px;
            }
            
            body.sidebar-expanded {
                padding-left: 250px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding-left: 0;
            }
            
            body.sidebar-expanded {
                padding-left: 0;
            }
            
            .netflix-sidebar {
                width: 0;
            }
            
            .netflix-sidebar.expanded {
                width: 250px;
            }
            
            .sidebar-backdrop {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 1040;
                display: none;
            }
            
            .sidebar-backdrop.show {
                display: block;
            }
            
            .mobile-sidebar-toggle {
                display: block;
            }
        }

        .sidebar-header {
            padding: 1.5rem 1rem;
            text-align: center;
        }

        .sidebar-toggle {
            position: absolute;
            top: 20px;
            right: -15px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--bs-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1051;
            cursor: pointer;
            border: none;
        }

        .sidebar-nav {
            list-style: none;
            padding: 0;
            margin-top: 2rem;
        }

        .sidebar-nav .nav-item {
            margin-bottom: 0.5rem;
        }

        .sidebar-nav .nav-link {
            color: #aaa;
            padding: 0.8rem 1.5rem;
            display: flex;
            align-items: center;
            white-space: nowrap;
            transition: all 0.3s;
        }

        .sidebar-nav .nav-link:hover,
        .sidebar-nav .nav-link.active {
            color: white;
            background-color: rgba(255, 255, 255, 0.1);
        }

        .sidebar-nav .nav-icon {
            font-size: 1.5rem;
            margin-right: 1rem;
            width: 24px;
            text-align: center;
        }

        .sidebar-nav .nav-text {
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .netflix-sidebar.expanded .sidebar-nav .nav-text {
            opacity: 1;
        }

        .sidebar-footer {
            margin-top: auto;
            padding: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Search functionality styles */
        .sidebar-search-form {
            transition: all 0.3s ease;
            opacity: 0;
            height: 0;
            overflow: hidden;
        }

        .netflix-sidebar.expanded .sidebar-search-form {
            opacity: 1;
            height: auto;
            margin-bottom: 1rem;
        }

        .search-results-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            display: none;
            overflow-y: auto;
        }

        .search-results-container {
            background-color: var(--bs-body-bg);
            width: 90%;
            max-width: 1200px;
            margin: 2rem auto;
            border-radius: 0.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .search-result-card {
            transition: transform 0.2s;
        }

        .search-result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        /* For dark mode compatibility */
        [data-bs-theme="dark"] .search-results-container {
            background-color: #2c3034;
            color: white;
        }

        [data-bs-theme="dark"] .search-results-header {
            border-bottom-color: #495057;
        }

        /* Add mobile hamburger menu button fixed to top left for closed sidebar */
        .mobile-sidebar-toggle {
            position: fixed;
            top: 1rem;
            left: 1rem;
            z-index: 1040;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--bs-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        @media (min-width: 768px) {
            .mobile-sidebar-toggle {
                display: none;
            }
        }

        /* Add this to your existing styles */
        .download-item {
            transition: all 0.2s ease;
        }

        [data-bs-theme="dark"] .download-item {
            background-color: #2c3034;
            color: white;
        }

        [data-bs-theme="dark"] .list-group-item {
            background-color: #2c3034;
            color: white;
            border-color: #495057;
        }

        [data-bs-theme="dark"] .list-group-item.active {
            background-color: #0d6efd;
            border-color: #0d6efd;
        }

        .download-poster {
            object-fit: cover;
        }

        .active-downloads-count {
            visibility: hidden;
        }

        .active-downloads-count:not(.d-none) {
            visibility: visible;
        }

        /* Movie Detail Modal Styles */
        .movie-detail-header {
            height: 50vh;
            min-height: 300px;
            max-height: 500px;
            position: relative;
            overflow: hidden;
        }

        .movie-backdrop {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('/api/placeholder/1600/900');
            background-size: cover;
            background-position: center top;
            filter: brightness(0.7);
            transition: all 0.3s ease;
        }

        .movie-header-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(0, 0, 0, 0.7), transparent 50%, rgba(0, 0, 0, 0.9));
        }

        .movie-title {
            font-size: 2.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        .movie-info-header {
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
        }

        /* Cast styling */
        .cast-img-container {
            width: 80px;
            height: 80px;
            margin: 0 auto;
            overflow: hidden;
        }

        .cast-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Modal fullscreen on mobile */
        .modal-xl {
            max-width: 95%;
        }

        /* Rating stars interactive behavior */
        .rating-stars {
            cursor: pointer;
        }

        .rating-stars i {
            margin-right: 5px;
            transition: all 0.2s;
        }

        .rating-stars i:hover,
        .rating-stars i.active {
            color: var(--bs-warning);
        }

        /* Dark mode specific styles */
        [data-bs-theme="dark"] .modal-content {
            background-color: #212529;
        }

        [data-bs-theme="dark"] .list-group-item {
            background-color: #2c3034;
            border-color: #495057;
        }

        [data-bs-theme="dark"] .card {
            background-color: #2c3034;
        }

        /* Mobile Optimizations */
        @media (max-width: 767px) {
            .movie-detail-header {
                height: 40vh;
                min-height: 200px;
            }

            .movie-title {
                font-size: 1.8rem;
            }
            
            .btn-lg {
                padding: 0.375rem 0.75rem;
                font-size: 1rem;
            }
            
            .cast-img-container {
                width: 60px;
                height: 60px;
            }
        }

        @media (max-width: 576px) {
            .movie-detail-header {
                height: 30vh;
            }
            
            .movie-title {
                font-size: 1.5rem;
            }
        }
    </style>
</head>

<body>
    <!-- Add this right after the opening <body> tag -->
    <div class="htmx-progress-bar" id="htmx-progress-bar"></div>

    <!-- HTML Changes - Remove the existing navbar and add the sidebar -->
    <!-- Add this sidebar code at the beginning of the body -->
    <div class="netflix-sidebar">
        <div class="sidebar-header">
            <a href="#" class="text-white text-decoration-none">
                <i class="bi bi-film text-primary sidebar-logo-icon fs-2"></i>
                <span class="sidebar-logo-text fw-bold d-none">MovieStream</span>
            </a>
        </div>
        <button class="sidebar-toggle" id="sidebarToggle">
            <i class="bi bi-chevron-right"></i>
        </button>
        <ul class="sidebar-nav">
            <li class="nav-item">
                <a href="#" class="nav-link active">
                    <i class="bi bi-house-door-fill nav-icon"></i>
                    <span class="nav-text">Home</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" id="sidebarSearchBtn" class="nav-link">
                    <i class="bi bi-search nav-icon"></i>
                    <span class="nav-text">Search</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <i class="bi bi-film nav-icon"></i>
                    <span class="nav-text">Movies</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <i class="bi bi-tv nav-icon"></i>
                    <span class="nav-text">TV Shows</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <i class="bi bi-star-fill nav-icon"></i>
                    <span class="nav-text">Top Rated</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <i class="bi bi-collection-play nav-icon"></i>
                    <span class="nav-text">Categories</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <i class="bi bi-bookmark-fill nav-icon"></i>
                    <span class="nav-text">My List</span>
                </a>
            </li>
            <!-- Add this button to your sidebar or navigation area -->
            <li class="nav-item">
                <a href="#" class="nav-link" data-bs-toggle="offcanvas" data-bs-target="#downloadsManager">
                    <i class="bi bi-download nav-icon"></i>
                    <span class="nav-text">Downloads</span>
                    <span class="badge rounded-pill bg-danger ms-2 active-downloads-count">0</span>
                </a>
            </li>
        </ul>
        <!-- Replace the sidebar-footer in the sidebar with this code to include search -->
        <div class="sidebar-footer">
            <form class="mb-3 sidebar-search-form">
                <div class="input-group">
                    <input class="form-control form-control-sm" type="search" placeholder="Search movies..."
                        id="sidebarSearch">
                    <button class="btn btn-primary btn-sm" type="submit">
                        <i class="bi bi-search"></i>
                    </button>
                </div>
            </form>
            <div class="d-flex justify-content-center">
                <button id="themeToggle" class="btn btn-outline-light btn-sm">
                    <i class="bi bi-moon-fill"></i>
                </button>
            </div>
        </div>
    </div>
    <div class="sidebar-backdrop"></div>

    <!-- Add this mobile toggle button to the body after the sidebar -->
    <button class="mobile-sidebar-toggle d-md-none" id="mobileSidebarToggle">
        <i class="bi bi-list fs-4"></i>
    </button>

    <!-- Add this search results UI below the sidebar -->
    <div class="search-results-overlay" id="searchResultsOverlay">
        <div class="search-results-container">
            <div class="search-results-header d-flex justify-content-between align-items-center p-3 border-bottom">
                <h5 class="mb-0 d-none d-md-block">Search Results: <span id="searchQueryDisplay">Action Movies</span>
                </h5>
                <div class="search-input-container flex-grow-1 mx-md-4">
                    <form id="overlaySearchForm" class="d-flex">
                        <input type="search" class="form-control" placeholder="Search movies..."
                            id="overlaySearchInput">
                        <button class="btn btn-primary ms-2" type="submit">
                            <i class="bi bi-search"></i>
                        </button>
                    </form>
                </div>
                <button class="btn-close ms-2" id="closeSearchResults"></button>
            </div>
            <div class="search-results-content p-3">
                <div class="row row-cols-2 row-cols-md-3 row-cols-lg-4 g-3">
                    <!-- Search Result Items -->
                    <div class="col">
                        <div class="card h-100 search-result-card">
                            <img src="/api/placeholder/300/450" class="card-img-top" alt="Movie Poster">
                            <div class="card-body">
                                <h6 class="card-title">Fast & Furious 10</h6>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="badge bg-warning text-dark">8.2 ★</span>
                                    <span class="badge bg-secondary">2023</span>
                                </div>
                            </div>
                            <div class="card-footer d-flex justify-content-between">
                                <button class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i> Watch</button>
                                <button class="btn btn-sm btn-outline-secondary"><i
                                        class="bi bi-info-circle"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 search-result-card">
                            <img src="/api/placeholder/300/450" class="card-img-top" alt="Movie Poster">
                            <div class="card-body">
                                <h6 class="card-title">John Wick 4</h6>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="badge bg-warning text-dark">9.0 ★</span>
                                    <span class="badge bg-secondary">2023</span>
                                </div>
                            </div>
                            <div class="card-footer d-flex justify-content-between">
                                <button class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i> Watch</button>
                                <button class="btn btn-sm btn-outline-secondary"><i
                                        class="bi bi-info-circle"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 search-result-card">
                            <img src="/api/placeholder/300/450" class="card-img-top" alt="Movie Poster">
                            <div class="card-body">
                                <h6 class="card-title">Mission Impossible</h6>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="badge bg-warning text-dark">8.7 ★</span>
                                    <span class="badge bg-secondary">2023</span>
                                </div>
                            </div>
                            <div class="card-footer d-flex justify-content-between">
                                <button class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i> Watch</button>
                                <button class="btn btn-sm btn-outline-secondary"><i
                                        class="bi bi-info-circle"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 search-result-card">
                            <img src="/api/placeholder/300/450" class="card-img-top" alt="Movie Poster">
                            <div class="card-body">
                                <h6 class="card-title">The Expendables 4</h6>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="badge bg-warning text-dark">7.5 ★</span>
                                    <span class="badge bg-secondary">2023</span>
                                </div>
                            </div>
                            <div class="card-footer d-flex justify-content-between">
                                <button class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i> Watch</button>
                                <button class="btn btn-sm btn-outline-secondary"><i
                                        class="bi bi-info-circle"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 search-result-card">
                            <img src="/api/placeholder/300/450" class="card-img-top" alt="Movie Poster">
                            <div class="card-body">
                                <h6 class="card-title">Bullet Train</h6>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="badge bg-warning text-dark">8.3 ★</span>
                                    <span class="badge bg-secondary">2022</span>
                                </div>
                            </div>
                            <div class="card-footer d-flex justify-content-between">
                                <button class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i> Watch</button>
                                <button class="btn btn-sm btn-outline-secondary"><i
                                        class="bi bi-info-circle"></i></button>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="card h-100 search-result-card">
                            <img src="/api/placeholder/300/450" class="card-img-top" alt="Movie Poster">
                            <div class="card-body">
                                <h6 class="card-title">The Gray Man</h6>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="badge bg-warning text-dark">7.8 ★</span>
                                    <span class="badge bg-secondary">2022</span>
                                </div>
                            </div>
                            <div class="card-footer d-flex justify-content-between">
                                <button class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i> Watch</button>
                                <button class="btn btn-sm btn-outline-secondary"><i
                                        class="bi bi-info-circle"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for download quality selection -->
    <div class="modal fade" id="downloadQualityModal" tabindex="-1" aria-labelledby="downloadQualityModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="downloadQualityModalLabel">Select Download Quality</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="movie-info d-flex align-items-center mb-4">
                        <img src="" alt="Movie Poster" id="downloadMoviePoster" class="rounded" width="80" height="120">
                        <div class="ms-3">
                            <h5 id="downloadMovieTitle" class="mb-1"></h5>
                            <div class="mb-2">
                                <span class="badge bg-secondary me-1" id="downloadMovieYear"></span>
                                <span class="badge bg-secondary" id="downloadMovieLength"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="list-group mb-3" id="qualityOptions">
                        <button type="button" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" data-quality="480p" data-size="650">
                            480p SD
                            <div>
                                <span class="badge bg-primary">650 MB</span>
                            </div>
                        </button>
                        <button type="button" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" data-quality="720p" data-size="1200">
                            720p HD
                            <div>
                                <span class="badge bg-primary">1.2 GB</span>
                            </div>
                        </button>
                        <button type="button" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" data-quality="1080p" data-size="2400">
                            1080p Full HD
                            <div>
                                <span class="badge bg-primary">2.4 GB</span>
                            </div>
                        </button>
                        <button type="button" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" data-quality="4k" data-size="5500">
                            4K Ultra HD
                            <div>
                                <span class="badge bg-primary">5.5 GB</span>
                            </div>
                        </button>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="startDownloadBtn" disabled>Download</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Movie Detail Modal -->
    <div class="modal fade" id="movieDetailModal" tabindex="-1" aria-labelledby="movieDetailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-fullscreen-lg-down">
            <div class="modal-content border-0">
                <!-- Modal Header with Backdrop -->
                <div class="movie-detail-header position-relative">
                    <!-- Backdrop Image -->
                    <div class="movie-backdrop"></div>

                    <!-- Overlay with Back Button -->
                    <div class="movie-header-overlay d-flex justify-content-between align-items-start p-3 p-md-4">
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                        <div class="d-flex">
                            <button class="btn btn-sm btn-outline-light me-2">
                                <i class="bi bi-heart"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-light">
                                <i class="bi bi-share"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Movie Info Header -->
                    <div class="movie-info-header position-absolute bottom-0 start-0 w-100 p-3 p-md-4">
                        <div class="row align-items-end">
                            <div class="col-md-8">
                                <h2 class="movie-title text-white mb-0">Movie Title</h2>
                                <div class="movie-meta d-flex flex-wrap align-items-center mt-2">
                                    <span class="badge bg-warning text-dark me-2">8.7 ★</span>
                                    <span class="text-white me-2">2023</span>
                                    <span class="text-white me-2">2h 15m</span>
                                    <span class="badge bg-primary me-2">HD</span>
                                </div>
                            </div>
                            <div class="col-md-4 mt-3 mt-md-0 text-md-end">
                                <button class="btn btn-primary btn-lg me-2">
                                    <i class="bi bi-play-fill"></i> Watch Now
                                </button>
                                <button class="btn btn-outline-light">
                                    <i class="bi bi-download"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal Body -->
                <div class="modal-body">
                    <div class="row">
                        <!-- Movie Information -->
                        <div class="col-md-8 order-md-1 order-2">
                            <!-- Genre Pills -->
                            <div class="mb-4">
                                <span class="badge rounded-pill bg-secondary me-2 mb-2">Action</span>
                                <span class="badge rounded-pill bg-secondary me-2 mb-2">Thriller</span>
                                <span class="badge rounded-pill bg-secondary me-2 mb-2">Science Fiction</span>
                            </div>

                            <!-- Movie Description -->
                            <h5>Synopsis</h5>
                            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam at feugiat nisi. Donec maximus, arcu ac tempor sagittis, nunc eros ultricies libero, vel lacinia odio enim eu turpis. Mauris accumsan vulputate leo, nec iaculis magna pulvinar ut.</p>

                            <!-- Cast Information -->
                            <h5 class="mt-4">Cast</h5>
                            <div class="row row-cols-2 row-cols-sm-3 row-cols-md-4 g-3 mb-4">
                                <div class="col">
                                    <div class="cast-member text-center">
                                        <div class="cast-img-container mb-2">
                                            <img src="/api/placeholder/150/150" class="rounded-circle cast-img" alt="Actor">
                                        </div>
                                        <h6 class="cast-name mb-0">Actor Name</h6>
                                        <small class="text-muted">Character</small>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="cast-member text-center">
                                        <div class="cast-img-container mb-2">
                                            <img src="/api/placeholder/150/150" class="rounded-circle cast-img" alt="Actor">
                                        </div>
                                        <h6 class="cast-name mb-0">Actor Name</h6>
                                        <small class="text-muted">Character</small>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="cast-member text-center">
                                        <div class="cast-img-container mb-2">
                                            <img src="/api/placeholder/150/150" class="rounded-circle cast-img" alt="Actor">
                                        </div>
                                        <h6 class="cast-name mb-0">Actor Name</h6>
                                        <small class="text-muted">Character</small>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="cast-member text-center">
                                        <div class="cast-img-container mb-2">
                                            <img src="/api/placeholder/150/150" class="rounded-circle cast-img" alt="Actor">
                                        </div>
                                        <h6 class="cast-name mb-0">Actor Name</h6>
                                        <small class="text-muted">Character</small>
                                    </div>
                                </div>
                            </div>

                            <!-- Additional Information -->
                            <div class="row">
                                <div class="col-sm-6">
                                    <h5>Details</h5>
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item d-flex justify-content-between px-0">
                                            <span>Released</span>
                                            <span>June 15, 2023</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between px-0">
                                            <span>Director</span>
                                            <span>Director Name</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between px-0">
                                            <span>Language</span>
                                            <span>English</span>
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-sm-6">
                                    <h5>Ratings</h5>
                                    <ul class="list-group list-group-flush">
                                        <li class="list-group-item d-flex justify-content-between px-0">
                                            <span>IMDB</span>
                                            <span>8.7/10</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between px-0">
                                            <span>Rotten Tomatoes</span>
                                            <span>92%</span>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between px-0">
                                            <span>Metacritic</span>
                                            <span>85/100</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Movie Poster (Mobile: Top, Desktop: Right) -->
                        <div class="col-md-4 order-md-2 order-1 mb-4 mb-md-0">
                            <div class="movie-poster-container">
                                <img src="/api/placeholder/500/750" class="img-fluid rounded shadow movie-poster" alt="Movie Poster">
                                <div class="mt-3">
                                    <button class="btn btn-primary w-100 mb-2">
                                        <i class="bi bi-play-fill"></i> Watch Now
                                    </button>
                                    <button class="btn btn-outline-secondary w-100">
                                        <i class="bi bi-download"></i> Download
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabs for Additional Content -->
                    <div class="mt-5">
                        <ul class="nav nav-tabs" id="movieDetailTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="similar-tab" data-bs-toggle="tab" data-bs-target="#similar" type="button" role="tab" aria-controls="similar" aria-selected="true">Similar Movies</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="reviews-tab" data-bs-toggle="tab" data-bs-target="#reviews" type="button" role="tab" aria-controls="reviews" aria-selected="false">Reviews</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="trailers-tab" data-bs-toggle="tab" data-bs-target="#trailers" type="button" role="tab" aria-controls="trailers" aria-selected="false">Trailers</button>
                            </li>
                        </ul>
                        <div class="tab-content pt-4" id="movieDetailTabContent">
                            <!-- Similar Movies Tab -->
                            <div class="tab-pane fade show active" id="similar" role="tabpanel" aria-labelledby="similar-tab">
                                <div class="scroll-container d-flex gap-3">
                                    <div class="movie-card rounded shadow">
                                        <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="Movie Poster">
                                        <div class="movie-overlay">
                                            <h5 class="card-title">Similar Movie 1</h5>
                                            <div class="d-flex justify-content-between">
                                                <span class="badge bg-warning text-dark">8.2 ★</span>
                                                <div class="btn-actions">
                                                    <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="movie-card rounded shadow">
                                        <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="Movie Poster">
                                        <div class="movie-overlay">
                                            <h5 class="card-title">Similar Movie 2</h5>
                                            <div class="d-flex justify-content-between">
                                                <span class="badge bg-warning text-dark">7.8 ★</span>
                                                <div class="btn-actions">
                                                    <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="movie-card rounded shadow">
                                        <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="Movie Poster">
                                        <div class="movie-overlay">
                                            <h5 class="card-title">Similar Movie 3</h5>
                                            <div class="d-flex justify-content-between">
                                                <span class="badge bg-warning text-dark">8.5 ★</span>
                                                <div class="btn-actions">
                                                    <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Reviews Tab -->
                            <div class="tab-pane fade" id="reviews" role="tabpanel" aria-labelledby="reviews-tab">
                                <!-- Reviews Content -->
                                <div class="mb-4">
                                    <!-- Review Form -->
                                    <div class="card mb-4">
                                        <div class="card-body">
                                            <h6>Leave a review</h6>
                                            <div class="mb-2 rating-stars">
                                                <i class="bi bi-star fs-5"></i>
                                                <i class="bi bi-star fs-5"></i>
                                                <i class="bi bi-star fs-5"></i>
                                                <i class="bi bi-star fs-5"></i>
                                                <i class="bi bi-star fs-5"></i>
                                            </div>
                                            <textarea class="form-control mb-3" rows="3" placeholder="Share your thoughts about this movie..."></textarea>
                                            <button class="btn btn-primary">Submit Review</button>
                                        </div>
                                    </div>

                                    <!-- User Reviews -->
                                    <div class="card mb-3">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between align-items-center mb-3">
                                                <div>
                                                    <h6 class="mb-0">John Doe</h6>
                                                    <div class="text-warning">
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star-half"></i>
                                                    </div>
                                                </div>
                                                <small class="text-muted">2 days ago</small>
                                            </div>
                                            <p class="card-text">This movie blew me away! The special effects were incredible and the story kept me engaged throughout. Definitely recommend watching it.</p>
                                        </div>
                                    </div>

                                    <div class="card">
                                        <div class="card-body">
                                            <div class="d-flex justify-content-between align-items-center mb-3">
                                                <div>
                                                    <h6 class="mb-0">Jane Smith</h6>
                                                    <div class="text-warning">
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star-fill"></i>
                                                        <i class="bi bi-star"></i>
                                                        <i class="bi bi-star"></i>
                                                    </div>
                                                </div>
                                                <small class="text-muted">1 week ago</small>
                                            </div>
                                            <p class="card-text">Good movie overall but the ending felt a bit rushed. The acting performances were excellent though.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Trailers Tab -->
                            <div class="tab-pane fade" id="trailers" role="tabpanel" aria-labelledby="trailers-tab">
                                <div class="row g-4">
                                    <div class="col-md-6">
                                        <div class="ratio ratio-16x9">
                                            <div class="bg-dark d-flex align-items-center justify-content-center text-white">
                                                <!-- Placeholder for video -->
                                                <div>
                                                    <i class="bi bi-play-circle fs-1"></i>
                                                    <p class="mt-2">Official Trailer</p>
                                                </div>
                                            </div>
                                        </div>
                                        <p class="mt-2">Official Trailer</p>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="ratio ratio-16x9">
                                            <div class="bg-dark d-flex align-items-center justify-content-center text-white">
                                                <!-- Placeholder for video -->
                                                <div>
                                                    <i class="bi bi-play-circle fs-1"></i>
                                                    <p class="mt-2">Teaser Trailer</p>
                                                </div>
                                            </div>
                                        </div>
                                        <p class="mt-2">Teaser Trailer</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Downloads Manager -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="downloadsManager" aria-labelledby="downloadsManagerLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="downloadsManagerLabel">Downloads</h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <ul class="nav nav-tabs mb-3" id="downloadsTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="active-downloads-tab" data-bs-toggle="tab" data-bs-target="#active-downloads" type="button" role="tab" aria-controls="active-downloads" aria-selected="true">Active</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="completed-downloads-tab" data-bs-toggle="tab" data-bs-target="#completed-downloads" type="button" role="tab" aria-controls="completed-downloads" aria-selected="false">Completed</button>
                </li>
            </ul>
            
            <div class="tab-content" id="downloadsTabContent">
                <!-- Active Downloads -->
                <div class="tab-pane fade show active" id="active-downloads" role="tabpanel" aria-labelledby="active-downloads-tab">
                    <div id="activeDownloadsList" hx-ext="sse" sse-connect="/api/downloads/events" sse-swap="progress">
                        <!-- Mock Download 1: In Progress -->
                        <div class="card mb-3 download-item" data-download-id="dl-1234">
                            <div class="card-body">
                                <div class="d-flex">
                                    <img src="https://m.media-amazon.com/images/M/MV5BMTU2NjA1ODgzMF5BMl5BanBnXkFtZTgwMTM2MTI4MjE@._V1_SX300.jpg" class="download-poster rounded" width="60" height="90" alt="Movie poster">
                                    <div class="ms-3 flex-grow-1">
                                        <h6 class="download-title mb-1">John Wick</h6>
                                        <div class="small mb-1">
                                            <span class="download-quality badge bg-secondary me-1">1080p</span>
                                            <span class="download-size badge bg-secondary">2.4 GB</span>
                                        </div>
                                        <div class="progress mt-2" style="height: 10px;">
                                            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 45%"></div>
                                        </div>
                                        <div class="d-flex justify-content-between align-items-center mt-2 text-muted small">
                                            <span class="download-status">45% - 12 min remaining</span>
                                            <span class="download-speed">3.2 MB/s</span>
                                        </div>
                                        <div class="mt-2">
                                            <button class="btn btn-sm btn-outline-danger" hx-post="/api/downloads/cancel" hx-vals='{"downloadId": "dl-1234"}' hx-swap="none">
                                                <i class="bi bi-x-circle"></i> Cancel
                                            </button>
                                            <button class="btn btn-sm btn-outline-primary pause-resume-btn" hx-post="/api/downloads/pause-resume" hx-vals='{"downloadId": "dl-1234"}' hx-swap="none">
                                                <i class="bi bi-pause-fill"></i> Pause
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Mock Download 2: Just Started -->
                        <div class="card mb-3 download-item" data-download-id="dl-5678">
                            <div class="card-body">
                                <div class="d-flex">
                                    <img src="https://m.media-amazon.com/images/M/MV5BNzA1Njg4NzYxOV5BMl5BanBnXkFtZTgwODk5NjU3MzI@._V1_SX300.jpg" class="download-poster rounded" width="60" height="90" alt="Movie poster">
                                    <div class="ms-3 flex-grow-1">
                                        <h6 class="download-title mb-1">Blade Runner 2049</h6>
                                        <div class="small mb-1">
                                            <span class="download-quality badge bg-secondary me-1">4K</span>
                                            <span class="download-size badge bg-secondary">5.5 GB</span>
                                        </div>
                                        <div class="progress mt-2" style="height: 10px;">
                                            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 8%"></div>
                                        </div>
                                        <div class="d-flex justify-content-between align-items-center mt-2 text-muted small">
                                            <span class="download-status">8% - 35 min remaining</span>
                                            <span class="download-speed">2.1 MB/s</span>
                                        </div>
                                        <div class="mt-2">
                                            <button class="btn btn-sm btn-outline-danger" hx-post="/api/downloads/cancel" hx-vals='{"downloadId": "dl-5678"}' hx-swap="none">
                                                <i class="bi bi-x-circle"></i> Cancel
                                            </button>
                                            <button class="btn btn-sm btn-outline-primary pause-resume-btn" hx-post="/api/downloads/pause-resume" hx-vals='{"downloadId": "dl-5678"}' hx-swap="none">
                                                <i class="bi bi-pause-fill"></i> Pause
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Mock Download 3: Paused -->
                        <div class="card mb-3 download-item" data-download-id="dl-9012">
                            <div class="card-body">
                                <div class="d-flex">
                                    <img src="https://m.media-amazon.com/images/M/MV5BMTMxNTMwODM0NF5BMl5BanBnXkFtZTcwODAyMTk2Mw@@._V1_SX300.jpg" class="download-poster rounded" width="60" height="90" alt="Movie poster">
                                    <div class="ms-3 flex-grow-1">
                                        <h6 class="download-title mb-1">The Dark Knight</h6>
                                        <div class="small mb-1">
                                            <span class="download-quality badge bg-secondary me-1">720p</span>
                                            <span class="download-size badge bg-secondary">1.2 GB</span>
                                        </div>
                                        <div class="progress mt-2" style="height: 10px;">
                                            <div class="progress-bar progress-bar-striped" role="progressbar" style="width: 72%"></div>
                                        </div>
                                        <div class="d-flex justify-content-between align-items-center mt-2 text-muted small">
                                            <span class="download-status">72% - Paused</span>
                                            <span class="download-speed">0 MB/s</span>
                                        </div>
                                        <div class="mt-2">
                                            <button class="btn btn-sm btn-outline-danger" hx-post="/api/downloads/cancel" hx-vals='{"downloadId": "dl-9012"}' hx-swap="none">
                                                <i class="bi bi-x-circle"></i> Cancel
                                            </button>
                                            <button class="btn btn-sm btn-outline-primary pause-resume-btn" hx-post="/api/downloads/pause-resume" hx-vals='{"downloadId": "dl-9012"}' hx-swap="none">
                                                <i class="bi bi-play-fill"></i> Resume
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Completed Downloads -->
                <div class="tab-pane fade" id="completed-downloads" role="tabpanel" aria-labelledby="completed-downloads-tab">
                    <div id="completedDownloadsList"
                        hx-get="/api/downloads/completed"
                        hx-trigger="load, newDownloadCompleted from:body">
                        <div class="text-center py-5 text-muted">
                            <i class="bi bi-check-circle fs-1"></i>
                            <p class="mt-2">No completed downloads</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Template for active download item -->
    <template id="downloadItemTemplate">
        <div class="card mb-3 download-item" data-download-id="">
            <div class="card-body">
                <div class="d-flex">
                    <img src="" class="download-poster rounded" width="60" height="90" alt="Movie poster">
                    <div class="ms-3 flex-grow-1">
                        <h6 class="download-title mb-1"></h6>
                        <div class="small mb-1">
                            <span class="download-quality badge bg-secondary me-1"></span>
                            <span class="download-size badge bg-secondary"></span>
                        </div>
                        <div class="progress mt-2" style="height: 10px;">
                            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%"></div>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mt-2 text-muted small">
                            <span class="download-status">Starting download...</span>
                            <span class="download-speed">0 MB/s</span>
                        </div>
                        <div class="mt-2">
                            <button class="btn btn-sm btn-outline-danger"
                                    hx-post="/api/downloads/cancel"
                                    hx-vals='{"downloadId": "${downloadId}"}'
                                    hx-swap="none">
                                <i class="bi bi-x-circle"></i> Cancel
                            </button>
                            <button class="btn btn-sm btn-outline-primary pause-resume-btn"
                                    hx-post="/api/downloads/pause-resume"
                                    hx-vals='{"downloadId": "${downloadId}"}'
                                    hx-swap="none">
                                <i class="bi bi-pause-fill"></i> Pause
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Hero Section with Featured Movie -->
    <section class="hero-section" style="background-image: url('https://images.unsplash.com/photo-1598899134739-24c46f58b8c0');">
        <div class="hero-overlay">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-md-8">
                        <h1 class="display-4 text-white fw-bold">Watch Free Movies Online</h1>
                        <p class="lead text-white">Stream and download thousands of movies and TV shows without registration.</p>
                        <div class="d-flex gap-2 mt-4">
                            <button class="btn btn-primary btn-lg">
                                <i class="bi bi-play-fill"></i> Watch Now
                            </button>
                            <button class="btn btn-outline-light btn-lg">
                                <i class="bi bi-download"></i> Download
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container mt-4">
        <!-- Categories -->
        <section class="mb-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="fs-4 fs-md-3">Categories</h2>
                <a href="#" class="text-decoration-none">View All</a>
            </div>
            <div class="category-pills-container d-flex flex-nowrap gap-2 overflow-auto pb-2">
                <span class="badge rounded-pill bg-primary fs-6 px-3 py-2 category-pill">Action</span>
                <span class="badge rounded-pill bg-success fs-6 px-3 py-2 category-pill">Comedy</span>
                <span class="badge rounded-pill bg-danger fs-6 px-3 py-2 category-pill">Horror</span>
                <span class="badge rounded-pill bg-warning text-dark fs-6 px-3 py-2 category-pill">Thriller</span>
                <span class="badge rounded-pill bg-info text-dark fs-6 px-3 py-2 category-pill">Sci-Fi</span>
                <span class="badge rounded-pill bg-secondary fs-6 px-3 py-2 category-pill">Drama</span>
                <span class="badge rounded-pill bg-dark fs-6 px-3 py-2 category-pill">Documentary</span>
                <span class="badge rounded-pill bg-primary fs-6 px-3 py-2 category-pill">Animation</span>
            </div>
        </section>

        <!-- Trending Movies -->
        <section class="mb-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="fs-4 fs-md-3">Trending Now</h2>
                <a href="#" class="text-decoration-none">View All</a>
            </div>
            <div class="scroll-container d-flex gap-3">
                <!-- Movie Cards -->
                <div class="movie-card rounded shadow" 
                     hx-get="/api/movies/details/${movieId}" 
                     hx-target="#movieDetailsContainer"
                     hx-trigger="click"
                     hx-push-url="true"
                     hx-indicator="#htmx-progress-bar"
                     data-movie-id="${movieId}">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="Movie Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">Action Movie</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">8.2 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <button class="btn btn-sm btn-primary watch-btn" onclick="event.stopPropagation();">
                                    <i class="bi bi-play-fill"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-light download-btn" onclick="event.stopPropagation();">
                                    <i class="bi bi-download"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="Movie Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">Sci-Fi Movie</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">7.5 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="Movie Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">Drama Movie</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">9.0 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="Movie Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">Comedy Movie</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">8.7 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="Movie Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">Horror Movie</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">7.8 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="Movie Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">Romantic Movie</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">7.8 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Latest Releases -->
        <section class="mb-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="fs-4 fs-md-3">Latest Releases</h2>
                <a href="#" class="text-decoration-none">View All</a>
            </div>
            <div class="scroll-container d-flex gap-3">
                <!-- Movie Cards -->
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="Movie Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">New Release</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">8.9 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="Movie Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">New Release</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">7.2 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="Movie Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">New Release</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">8.5 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="Movie Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">New Release</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">9.1 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="Movie Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">New Release</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">7.7 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Popular TV Shows -->
        <section class="mb-4">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="fs-4 fs-md-3">Popular TV Shows</h2>
                <a href="#" class="text-decoration-none">View All</a>
            </div>
            <div class="scroll-container d-flex gap-3">
                <!-- TV Show Cards -->
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="TV Show Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">TV Show</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">9.2 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="TV Show Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">TV Show</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">8.8 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="TV Show Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">TV Show</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">8.3 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="TV Show Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">TV Show</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">7.9 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="movie-card rounded shadow">
                    <img src="/api/placeholder/300/450" class="movie-poster rounded" alt="TV Show Poster">
                    <div class="movie-overlay">
                        <h5 class="card-title">TV Show</h5>
                        <div class="d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning text-dark">8.6 ★</span>
                                <span class="badge bg-secondary">2023</span>
                            </div>
                            <div class="btn-actions">
                                <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-play-fill"></i></a>
                                <a href="#" class="btn btn-sm btn-outline-light download-btn" 
                                   data-movie-id="${movieId}" 
                                   data-movie-title="${movieTitle}" 
                                   data-movie-year="${movieYear}" 
                                   data-movie-length="${movieLength}"
                                   data-movie-poster="${moviePoster}">
                                  <i class="bi bi-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Newsletter Subscription -->
        <section class="py-5 px-3 bg-primary text-white rounded shadow-lg mb-5">
            <div class="row align-items-center">
                <div class="col-lg-6 mb-4 mb-lg-0">
                    <h2>Stay Updated!</h2>
                    <p class="lead">Subscribe to our newsletter for the latest movies and TV shows.</p>
                </div>
                <div class="col-lg-6">
                    <form class="row g-3">
                        <div class="col-md-8">
                            <input type="email" class="form-control form-control-lg" placeholder="Your email address">
                        </div>
                        <div class="col-md-4">
                            <button type="submit" class="btn btn-light btn-lg w-100">Subscribe</button>
                        </div>
                    </form>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-dark text-white">
        <div class="container py-4">
            <div class="row gy-4">
                <div class="col-md-4">
                    <h5 class="mb-3">MovieStream</h5>
                    <p class="small">Your go-to destination for free movies and TV shows online. Stream or download your
                        favorite content without any registration.</p>
                    <div class="d-flex gap-3 mt-3">
                        <a href="#" class="text-white"><i class="bi bi-facebook"></i></a>
                        <a href="#" class="text-white"><i class="bi bi-twitter"></i></a>
                        <a href="#" class="text-white"><i class="bi bi-instagram"></i></a>
                        <a href="#" class="text-white"><i class="bi bi-telegram"></i></a>
                    </div>
                </div>
                <div class="col-6 col-md-2">
                    <h6 class="mb-2">Quick Links</h6>
                    <ul class="list-unstyled small">
                        <li class="mb-1"><a href="#" class="text-white text-decoration-none">Home</a></li>
                        <li class="mb-1"><a href="#" class="text-white text-decoration-none">Movies</a></li>
                        <li class="mb-1"><a href="#" class="text-white text-decoration-none">TV Shows</a></li>
                        <li class="mb-1"><a href="#" class="text-white text-decoration-none">Top IMDB</a></li>
                    </ul>
                </div>
                <div class="col-6 col-md-2">
                    <h6 class="mb-2">Categories</h6>
                    <ul class="list-unstyled small">
                        <li class="mb-1"><a href="#" class="text-white text-decoration-none">Action</a></li>
                        <li class="mb-1"><a href="#" class="text-white text-decoration-none">Comedy</a></li>
                        <li class="mb-1"><a href="#" class="text-white text-decoration-none">Horror</a></li>
                        <li class="mb-1"><a href="#" class="text-white text-decoration-none">Drama</a></li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h6 class="mb-2">Contact Us</h6>
                    <ul class="list-unstyled small">
                        <li class="mb-1"><i class="bi bi-envelope me-2"></i> contact@moviestream.com</li>
                        <li class="mb-1"><i class="bi bi-telephone me-2"></i> +1 (123) 456-7890</li>
                        <li class="mb-1"><i class="bi bi-geo-alt me-2"></i> Los Angeles, CA, USA</li>
                    </ul>
                </div>
            </div>
            <hr class="my-3 bg-light">
            <div class="row">
                <div class="col-md-6 mb-2 mb-md-0">
                    <p class="mb-0 small">&copy; 2025 MovieStream. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <a href="#" class="text-white text-decoration-none me-3">Privacy Policy</a>
                    <a href="#" class="text-white text-decoration-none me-3">Terms of Service</a>
                    <a href="#" class="text-white text-decoration-none">DMCA</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const themeToggleBtn = document.getElementById('themeToggle');
            const htmlElement = document.documentElement;

            // Check for saved theme preference or use preferred color scheme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                htmlElement.setAttribute('data-bs-theme', savedTheme);
                updateThemeIcon(savedTheme);
            } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                htmlElement.setAttribute('data-bs-theme', 'dark');
                updateThemeIcon('dark');
            }

            // Toggle theme on button click
            themeToggleBtn.addEventListener('click', function () {
                const currentTheme = htmlElement.getAttribute('data-bs-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

                htmlElement.setAttribute('data-bs-theme', newTheme);
                localStorage.setItem('theme', newTheme);
                updateThemeIcon(newTheme);
            });

            // Update button icon based on current theme
            function updateThemeIcon(theme) {
                if (theme === 'dark') {
                    themeToggleBtn.innerHTML = '<i class="bi bi-sun-fill"></i>';
                    // themeToggleBtn.classList.remove('btn-outline-dark');
                    // themeToggleBtn.classList.add('btn-outline-light');
                } else {
                    themeToggleBtn.innerHTML = '<i class="bi bi-moon-fill"></i>';
                    // themeToggleBtn.classList.remove('btn-outline-light');
                    // themeToggleBtn.classList.add('btn-outline-dark');
                }
            }
        });

        document.addEventListener('DOMContentLoaded', function () {
            // Existing theme toggle code...

            // Sidebar toggle functionality
            const sidebar = document.querySelector('.netflix-sidebar');
            const sidebarToggle = document.getElementById('sidebarToggle');
            const mobileSidebarToggle = document.getElementById('mobileSidebarToggle');
            const sidebarBackdrop = document.querySelector('.sidebar-backdrop');
            const body = document.body;
            const sidebarLogoText = document.querySelector('.sidebar-logo-text');

            function toggleSidebar() {
                sidebar.classList.toggle('expanded');
                body.classList.toggle('sidebar-expanded');
                sidebarBackdrop.classList.toggle('show');

                const isExpanded = sidebar.classList.contains('expanded');
                sidebarToggle.innerHTML = isExpanded ?
                    '<i class="bi bi-chevron-left"></i>' :
                    '<i class="bi bi-chevron-right"></i>';

                if (isExpanded) {
                    sidebarLogoText.classList.remove('d-none');
                    setTimeout(() => {
                        sidebarLogoText.style.opacity = 1;
                    }, 100);
                } else {
                    sidebarLogoText.style.opacity = 0;
                    setTimeout(() => {
                        sidebarLogoText.classList.add('d-none');
                    }, 300);
                }
            }

            sidebarToggle.addEventListener('click', toggleSidebar);
            mobileSidebarToggle.addEventListener('click', toggleSidebar);
            sidebarBackdrop.addEventListener('click', toggleSidebar);

            // Close sidebar when clicking a link on mobile
            const navLinks = document.querySelectorAll('.sidebar-nav .nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', function () {
                    if (window.innerWidth < 768 && sidebar.classList.contains('expanded')) {
                        toggleSidebar();
                    }
                });
            });

            // Handle window resize
            window.addEventListener('resize', function () {
                if (window.innerWidth > 768) {
                    sidebarBackdrop.classList.remove('show');
                } else {
                    if (sidebar.classList.contains('expanded')) {
                        sidebarBackdrop.classList.add('show');
                    }
                }
            });
        });

        // Search functionality
        document.addEventListener('DOMContentLoaded', function () {
            const searchForm = document.querySelector('.sidebar-search-form');
            const searchInput = document.getElementById('sidebarSearch');
            const searchResultsOverlay = document.getElementById('searchResultsOverlay');
            const searchQueryDisplay = document.getElementById('searchQueryDisplay');
            const closeSearchResults = document.getElementById('closeSearchResults');

            // Handle search form submission
            searchForm.addEventListener('submit', function (e) {
                e.preventDefault();

                // Get search query
                const query = searchInput.value.trim();

                if (query) {
                    // Show search results
                    searchQueryDisplay.textContent = query;
                    searchResultsOverlay.style.display = 'block';
                    document.body.style.overflow = 'hidden'; // Prevent scrolling behind overlay
                }
            });

            // Close search results
            closeSearchResults.addEventListener('click', function () {
                searchResultsOverlay.style.display = 'none';
                document.body.style.overflow = 'auto'; // Re-enable scrolling
            });

            // Close search results when clicking outside
            searchResultsOverlay.addEventListener('click', function (e) {
                if (e.target === searchResultsOverlay) {
                    searchResultsOverlay.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });

            // Add to your existing search functionality code
            const overlaySearchForm = document.getElementById('overlaySearchForm');
            const overlaySearchInput = document.getElementById('overlaySearchInput');

            // Connect the overlay search form
            overlaySearchForm.addEventListener('submit', function (e) {
                e.preventDefault();
                const query = overlaySearchInput.value.trim();
                if (query) {
                    searchQueryDisplay.textContent = query;
                    // Here you would typically trigger the actual search functionality
                }
            });

            // When opening the search overlay, focus the input
            searchResultsOverlay.addEventListener('transitionend', function () {
                if (searchResultsOverlay.style.display === 'block') {
                    overlaySearchInput.focus();
                }
            });

            // Add search button in sidebar functionality
            const sidebarSearchBtn = document.getElementById('sidebarSearchBtn');

            sidebarSearchBtn.addEventListener('click', function (e) {
                e.preventDefault();

                // Open search overlay directly when clicking the search icon
                searchResultsOverlay.style.display = 'block';
                document.body.style.overflow = 'hidden'; // Prevent scrolling behind overlay

                // If sidebar is expanded on mobile, toggle it
                if (window.innerWidth < 768 && sidebar.classList.contains('expanded')) {
                    toggleSidebar();
                }

                // Focus the search input for better UX
                setTimeout(() => {
                    overlaySearchInput.focus();
                }, 100);
            });

            // Optional: Add keyboard shortcut for search
            document.addEventListener('keydown', function (e) {
                // When '/' key is pressed outside of form inputs
                if (e.key === '/' && document.activeElement.tagName !== 'INPUT' &&
                    document.activeElement.tagName !== 'TEXTAREA') {
                    e.preventDefault();
                    searchResultsOverlay.style.display = 'block';
                    document.body.style.overflow = 'hidden';
                    setTimeout(() => overlaySearchInput.focus(), 100);
                }

                // Close search with Escape key
                if (e.key === 'Escape' && searchResultsOverlay.style.display === 'block') {
                    searchResultsOverlay.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });

        });

        // Add this JavaScript to handle download interactions
        document.addEventListener('DOMContentLoaded', function() {
            // Handle clicks on download buttons
            document.addEventListener('click', function(e) {
                if (e.target.closest('.download-btn')) {
                    e.preventDefault();
                    const btn = e.target.closest('.download-btn');
                    const movieData = {
                        id: btn.dataset.movieId,
                        title: btn.dataset.movieTitle,
                        year: btn.dataset.movieYear,
                        length: btn.dataset.movieLength,
                        poster: btn.dataset.moviePoster
                    };
                    
                    // Set modal data
                    document.getElementById('downloadMovieTitle').textContent = movieData.title;
                    document.getElementById('downloadMovieYear').textContent = movieData.year;
                    document.getElementById('downloadMovieLength').textContent = movieData.length + ' min';
                    document.getElementById('downloadMoviePoster').src = movieData.poster;
                    document.getElementById('downloadMoviePoster').alt = movieData.title + ' poster';
                    
                    // Store selected movie data
                    window.selectedMovie = movieData;
                    window.selectedQuality = null;
                    
                    // Open the modal
                    const downloadModal = new bootstrap.Modal(document.getElementById('downloadQualityModal'));
                    downloadModal.show();
                }
            });
            
            // Handle quality selection
            const qualityOptions = document.querySelectorAll('#qualityOptions .list-group-item');
            const startDownloadBtn = document.getElementById('startDownloadBtn');
            
            qualityOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove active class from all options
                    qualityOptions.forEach(op => op.classList.remove('active'));
                    // Add active class to selected option
                    this.classList.add('active');
                    // Enable download button
                    startDownloadBtn.disabled = false;
                    // Store selected quality
                    window.selectedQuality = {
                        quality: this.dataset.quality,
                        size: this.dataset.size
                    };
                });
            });
            
            // Handle start download button click
            startDownloadBtn.addEventListener('click', function() {
                if (window.selectedMovie && window.selectedQuality) {
                    // Hide the modal
                    bootstrap.Modal.getInstance(document.getElementById('downloadQualityModal')).hide();
                    
                    // Start download process
                    startDownload(window.selectedMovie, window.selectedQuality);
                    
                    // Open downloads manager
                    const downloadsManager = new bootstrap.Offcanvas(document.getElementById('downloadsManager'));
                    downloadsManager.show();
                }
            });
            
            // Function to start download
            function startDownload(movie, quality) {
                fetch('/api/downloads/start', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        movieId: movie.id,
                        quality: quality.quality
                    })
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Download started:', data);
                    // Update download counter
                    updateDownloadCounter();
                })
                .catch(error => {
                    console.error('Error starting download:', error);
                    // Show error toast
                    showToast('Error', 'Failed to start download. Please try again.', 'danger');
                });
            }
            
            // Update download counter
            function updateDownloadCounter() {
                fetch('/api/downloads/active/count')
                    .then(response => response.json())
                    .then(data => {
                        const countElement = document.querySelector('.active-downloads-count');
                        countElement.textContent = data.count;
                        if (data.count > 0) {
                            countElement.classList.remove('d-none');
                        } else {
                            countElement.classList.add('d-none');
                        }
                    });
            }
            
            // Toast notification function
            function showToast(title, message, type = 'primary') {
                const toastContainer = document.getElementById('toastContainer') || createToastContainer();
                const toastId = 'toast-' + Date.now();
                
                const toastHtml = `
                    <div class="toast" role="alert" aria-live="assertive" aria-atomic="true" id="${toastId}">
                        <div class="toast-header bg-${type} text-white">
                            <strong class="me-auto">${title}</strong>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
                        </div>
                        <div class="toast-body">
                            ${message}
                        </div>
                    </div>
                `;
                
                toastContainer.insertAdjacentHTML('beforeend', toastHtml);
                const toastElement = document.getElementById(toastId);
                const toast = new bootstrap.Toast(toastElement, { autohide: true, delay: 5000 });
                toast.show();
                
                toastElement.addEventListener('hidden.bs.toast', function() {
                    this.remove();
                });
            }
            
            function createToastContainer() {
                const container = document.createElement('div');
                container.id = 'toastContainer';
                container.className = 'toast-container position-fixed bottom-0 end-0 p-3';
                container.style.zIndex = '1050';
                document.body.appendChild(container);
                return container;
            }
            
            // Initialize SSE features
            htmx.defineExtension('sse', {
                onEvent: function(name, event) {
                    if (name === 'progress') {
                        updateDownloadProgress(JSON.parse(event.data));
                    } else if (name === 'download-complete') {
                        const downloadData = JSON.parse(event.data);
                        handleDownloadComplete(downloadData);
                        // Trigger update of completed downloads list
                        htmx.trigger('#completedDownloadsList', 'newDownloadCompleted');
                        updateDownloadCounter();
                    } else if (name === 'download-error') {
                        const errorData = JSON.parse(event.data);
                        showToast('Download Error', errorData.message, 'danger');
                    }
                }
            });
            
            // Update download progress
            function updateDownloadProgress(data) {
                // Find or create download item
                let downloadItem = document.querySelector(`.download-item[data-download-id="${data.id}"]`);
                
                if (!downloadItem) {
                    // Create new download item
                    downloadItem = createDownloadItem(data);
                    const activeDownloadsList = document.getElementById('activeDownloadsList');
                    if (activeDownloadsList.querySelector('.text-center')) {
                        activeDownloadsList.innerHTML = ''; // Remove "No active downloads" message
                    }
                    activeDownloadsList.appendChild(downloadItem);
                }
                
                // Update progress
                const progressBar = downloadItem.querySelector('.progress-bar');
                progressBar.style.width = `${data.progress}%`;
                
                // Update status and speed
                const statusElement = downloadItem.querySelector('.download-status');
                const speedElement = downloadItem.querySelector('.download-speed');
                
                statusElement.textContent = `${data.progress}% - ${data.timeRemaining}`;
                speedElement.textContent = data.speed;
                
                // Update pause/resume button if needed
                if (data.status === 'PAUSED') {
                    const pauseBtn = downloadItem.querySelector('.pause-resume-btn');
                    pauseBtn.innerHTML = '<i class="bi bi-play-fill"></i> Resume';
                } else if (data.status === 'DOWNLOADING') {
                    const pauseBtn = downloadItem.querySelector('.pause-resume-btn');
                    pauseBtn.innerHTML = '<i class="bi bi-pause-fill"></i> Pause';
                }
                
                // Update download counter
                updateDownloadCounter();
            }
            
            // Create new download item
            function createDownloadItem(data) {
                const template = document.getElementById('downloadItemTemplate');
                const clone = document.importNode(template.content, true);
                const downloadItem = clone.querySelector('.download-item');
                
                // Set download id
                downloadItem.dataset.downloadId = data.id;
                
                // Set movie details
                downloadItem.querySelector('.download-poster').src = data.poster;
                downloadItem.querySelector('.download-title').textContent = data.title;
                downloadItem.querySelector('.download-quality').textContent = data.quality;
                downloadItem.querySelector('.download-size').textContent = data.size;
                
                // Set initial progress
                downloadItem.querySelector('.progress-bar').style.width = `${data.progress}%`;
                
                // Set cancel and pause/resume button data
                const buttons = downloadItem.querySelectorAll('button');
                buttons.forEach(button => {
                    if (button.hasAttribute('hx-vals')) {
                        const vals = button.getAttribute('hx-vals').replace('${downloadId}', data.id);
                        button.setAttribute('hx-vals', vals);
                    }
                });
                
                return downloadItem;
            }
            
            // Handle download completion
            function handleDownloadComplete(data) {
                // Remove from active downloads
                const downloadItem = document.querySelector(`.download-item[data-download-id="${data.id}"]`);
                if (downloadItem) {
                    downloadItem.remove();
                }
                
                // Check if active downloads is empty
                const activeDownloadsList = document.getElementById('activeDownloadsList');
                if (activeDownloadsList.children.length === 0) {
                    activeDownloadsList.innerHTML = `
                        <div class="text-center py-5 text-muted">
                        <i class="bi bi-download fs-1"></i>
                        <p class="mt-2">No active downloads</p>
                        </div>
                    `;
                }
                
                // Show completion toast
                showToast('Download Complete', `"${data.title}" has been downloaded successfully.`, 'success');
            }
        });

        // Add this to your existing JavaScript code, at the end of your DOMContentLoaded event
        document.addEventListener('DOMContentLoaded', function() {
            // Existing code...

            // Fix for modals and offcanvas not closing with back button
            const modals = [
                { id: 'downloadQualityModal', type: 'modal' },
                { id: 'downloadsManager', type: 'offcanvas' },
                { id: 'searchResultsOverlay', type: 'custom' },
                { id: 'movieDetailModal', type: 'modal' }  // Add this line to include the movie detail modal
            ];
            
            // Function to add current state to history when opening a modal
            function addModalStateToHistory(modalId) {
                const currentState = { modal: modalId };
                const currentUrl = window.location.href;
                history.pushState(currentState, '', currentUrl);
            }
            
            // Listen for modal/offcanvas open events
            modals.forEach(modal => {
                if (modal.type === 'modal') {
                    const element = document.getElementById(modal.id);
                    element.addEventListener('shown.bs.modal', function() {
                        addModalStateToHistory(modal.id);
                    });
                } else if (modal.type === 'offcanvas') {
                    const element = document.getElementById(modal.id);
                    element.addEventListener('shown.bs.offcanvas', function() {
                        addModalStateToHistory(modal.id);
                    });
                } else if (modal.type === 'custom') {
                    // For the custom search overlay
                    const element = document.getElementById(modal.id);
                    const closeBtn = document.getElementById('closeSearchResults');
                    
                    // Override the original open/close logic
                    const originalOpenSearch = function() {
                        element.style.display = 'block';
                        document.body.style.overflow = 'hidden';
                        addModalStateToHistory(modal.id);
                    };
                    
                    // Store references to any elements that open the search
                    const searchBtns = [
                        document.getElementById('sidebarSearchBtn')
                    ];
                    
                    searchBtns.forEach(btn => {
                        if (btn) {
                            // Remove existing listeners (may need to adapt this)
                            const newBtn = btn.cloneNode(true);
                            btn.parentNode.replaceChild(newBtn, btn);
                            
                            // Add new listener
                            newBtn.addEventListener('click', function(e) {
                                e.preventDefault();
                                originalOpenSearch();
                            });
                        }
                    });
                }
            });
            
            // Handle browser back button
            window.addEventListener('popstate', function(event) {
                // Close any open modals/offcanvas/overlays
                modals.forEach(modal => {
                    if (modal.type === 'modal') {
                        const modalInstance = bootstrap.Modal.getInstance(document.getElementById(modal.id));
                        if (modalInstance) {
                            modalInstance.hide();
                        }
                    } else if (modal.type === 'offcanvas') {
                        const offcanvasInstance = bootstrap.Offcanvas.getInstance(document.getElementById(modal.id));
                        if (offcanvasInstance) {
                            offcanvasInstance.hide();
                        }
                    } else if (modal.type === 'custom') {
                        const element = document.getElementById(modal.id);
                        if (element.style.display === 'block') {
                            element.style.display = 'none';
                            document.body.style.overflow = 'auto'; // Re-enable scrolling
                        }
                    }
                });
            });
        });

        // Add this to your existing JavaScript code
        document.addEventListener('DOMContentLoaded', function() {
            // Handle movie card clicks
            const movieCards = document.querySelectorAll('.movie-card');
            const movieDetailModal = new bootstrap.Modal(document.getElementById('movieDetailModal'));
            
            movieCards.forEach(card => {
                card.addEventListener('click', function(e) {
                    if (!e.target.closest('a')) {  // Don't trigger if clicking an action button
                        movieDetailModal.show();
                        
                        // You would typically fetch movie details here and populate the modal
                        // For now we're just showing the modal with placeholder data
                    }
                });
            });
            
            // Rating stars functionality
            const ratingStars = document.querySelector('.rating-stars');
            if (ratingStars) {
                const stars = ratingStars.querySelectorAll('i');
                
                stars.forEach((star, index) => {
                    star.addEventListener('click', () => {
                        stars.forEach((s, i) => {
                            if (i <= index) {
                                s.classList.remove('bi-star');
                                s.classList.add('bi-star-fill');
                                s.classList.add('active');
                            } else {
                                s.classList.add('bi-star');
                                s.classList.remove('bi-star-fill');
                                s.classList.remove('active');
                            }
                        });
                    });
                });
            }
        });

    </script>
    <!-- Add these right before closing </body> tag -->
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10/dist/ext/sse.js"></script>

</body>

</html>